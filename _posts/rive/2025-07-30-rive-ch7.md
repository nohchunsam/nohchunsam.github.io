---
title: Rive 튜토리얼 - Ch.7 상태 머신
date: 2025-07-30 14:19:00 +0900
categories: Rive
tags: ["Rive", "공부"]
---

## 7.1 상태 머신 개요 State Machine Overview

- Rive 파일이 상호작용할 수 있게 해준다!
- 상태 머신State machine은 애니메이션 모드에서 사용할 수 있다.

- 애니메이션에 들어가면 기본적으로 State Machine1이 있다. State Machine1에는 기본적으로 Timeline1이 연결돼 있다.
- State Macine1에서도 Timeline1을 실행할 수 있다.

### 상태 머신 그래프

![](img/rive_ch7/state_machine_ui.png)

- 위의 여러 버튼이 이어진 것들을 상태 머신 그래프라고 한다.
- 초록색은 도입Entry, 파란색은 평상태Any State, 빨간색은 종료Exist를 뜻한다. 각 버튼은 상태State라고 한다.
- 도입은 상태 머신에 어느 상태를 시작해야하는지 알려준다. 다른 상태와 연결해 시작할 상태를 정할 수 있다. 현재는 Timeline1과 연결돼 있다.
- 그래프에서 각 상태를 자유롭게 드래그해 이동할 수 있다. 그래프에서 스내핑이 적용된다. (끄면 사라진다.)
- 상태는 `Del`키로 자유롭게 삭제할 수 있다.

### 이동
- `Space bar`를 누른 상태/우클릭으로 그래프 화면을 자유롭게 움직일 수 있다.
- `+`와 `-`로 줌인/줌아웃할 수 있다.
- `F`키로 화면을 현 상태에 맞출 수 있다.

## 7.2 단일 애니메이션 상태 Single Animation States

- 애니메이션 타임라인의 재생방식에 따라 해당 상태의 아이콘도 바뀐다. (Ping Pong도 마찬가지)

![](img/rive_ch7/oneshot_timeline_state.png)

![](img/rive_ch7/loop_timeline_state.png)


- 모든 애니메이션 타임라인은 상태로 사용할 수 있다.

### 상태의 타임라인 변경법

- 상태를 클릭한 후, 옆의 인스펙터에서 타임라인을 변경한다.

![](img/rive_ch7/change_single_timeline.png)

- 기존의 타임라인은 삭제, 추가할 타임라인을 그래프로 드래그한 후, 상태의 테두리에 있는 점을 그대로 드래그해 선을 더한다.

![](img/rive_ch7/add_line.png)

- 우클릭을 통해 상태를 더하고, 인스펙터를 통해 타임라인을 설정할 수 있다.

- 상태를 더블클릭하면 해당 애니메이션 타임라인으로 들어갈 수 있다.
- 인스펙터에서 타임라인 재생을 설정할 수 있다. 배수로 더 빠르게, 0~0.99 값으로 느리게, 음수값으로 역재생을 할 수 있다.

## 7.3 레이어Layers

- 레이어를 사용해 동시에 여러 타임라인을 실행할 수 있다.
- 기본적으로 한 상태 머신은 한 레이어를 가진다.

![](img/rive_ch7/layer_ui.png)

- 레이어 버튼을 더블클릭해 이름을 변경할 수 있다.
- 옆의 + 버튼을 눌러 레이어를 추가할 수 있다.
- 새 레이어에 다른 타임라인을 추가해, 동시에 여러 타임라인을 실행할 수 있다.
- 한 레이어에는 루프 애니메이션을, 한 레이어에는 눈 깜빡임 애니메이션을 만들고 각각 레이어를 사용해 애니메이션들을 동시에 실행할 수 있다.

## 7.4 레이어와 혼합 Layers and Mixing

- 타임라인마다 객체의 각 속성을 애니메이팅하고, 레이어를 추가해 동시에 실행시킬 수 있다.
- 속성 별로, 타임라인을 분리해서 애니메이팅할 수 있다.

실습을 해보는 걸 추천한다.

![](img/rive_ch7/layers_mixing.png)

## 7.5 레이어 순서 Layer Order

- 같은 속성을 애니메이팅하는 여러 타임라인이 있을 경우, 해당 타임라인을 가진 레이어들 중 가장 오른쪽에 있는 레이어가 최종적으로 적용된다.
- 레이어를 드래그해서 순서를 바꿀 수 있다.

## 7.6 전환 Transitions
- 한 상태에서 다른 상태로 전환하게 해준다. 상태 머신에서 논리적 흐름을 만들도록 해준다.

- 다음과 같이 한 상태에서 다음 상태로 잇는 것을 전환이라고 한다. (화살표 선)
- 전환은 상태의 테두리에 마우스 갖다댈 때 생기는 점을 드래그해, 다른 상태와 이어서 만들 수 있다.

![](img/rive_ch7/one_direction_transition.png)

- 쌍방향 전환도 가능하다. 서로 전환을 추가하면 된다.

![](img/rive_ch7/two_direction_transition.png)

- 전환을 다양하게 설정할 수도 있다. 계속해서 설명할 예정!

## 7.7 전환 기간 Transitions duration

- 전환 기간Transition duration은 상태 간 전환이 얼마나 오래 걸리는지를 설정하는 값이다.
- 단위는 밀리세컨드ms이다.
- 예로, 전환 기간이 0ms이면 상태가 즉시 변경되며, 500ms로 설정하면 해당 시간 동안 중간 프레임이 들어가(보간되어interpolate) 부드럽게 전환된다.
- 전환 인스펙터에서 보간interpolate을 설정할 수 있다. 큐빅, 엘라스틱Elastic등을 설정해 전환을 애니메이션할 수 있다.

> 전환 인스펙터에서 스크롤 다운하면 그래프가 나온다.

## 7.8 종료 시간 Exit Time

- 타임라인 A에서 타임라인 B로 연결=전환하고, 재생을 할 경우 B만 재생이 된다. A도 재생하려면 조건이나 입력이 필요하다.
- 이럴 때 종료 시간을 설정한다.

![](img/rive_ch7/exit_time.png)

- 이렇게 시간을 입력하면, 종료 시간까지 타임라인 A의 애니메이션을 재생한 후 타임라인 B로 전환한다.
- 전체 애니메이션을 재생하고 전환하고 싶으면 A 애니메이션의 재생 시간을, 절반만 재생하고 전환하고 싶다면 A 애니메이션 재생 시간의 절반을 입력한다. 
- 현재는 시간(단위 ms)이 입력돼 있지만, 수를 입력하고 뒤에 %를 붙이면 비율- 퍼센트로 전환할 수 있다. 시간은 ms를 붙이면 전환된다.

> 종료 시간은 상태의 실행 시간을, 전환 기간은 두 상태에서 전환하는 데 걸리는 시간을 의미한다. 전환 기간은 전환하는데 보간을 넣는다. 둘은 엄연히 다르니 주의하자...

## 7.9 종료할때 멈추기 Pause When Exiting

- 루프 애니메이션에서 다른 애니메이션으로 전환할 때, 전환 기간을 설정하면 그 시간만큼 루프 애니메이션이 재생하게 된다.
- 이를 막기 위해서는 Pause source when exiting을 체크한다.

![](img/rive_ch7/pause_when_exiting.png)

## 7.10 입력 Inputs

- 입력을 통해 전환을 제어할 수 있다. 
- 개발자는 런타임에 입력을 변경해, 상태 머신 내의 상태를 전환할 수 있다.

![](img/rive_ch7/inputs.png)

- 해당 창을 통해 입력을 추가할 수 있다.
- 숫자Number: 말그대로 숫자(정수) 값을 가진다.
- 불리안Boolean: 참 또는 거짓 값을 가진다. (체크=true, 체크없음=false)
- 트리거Trigger: 클릭하는 순간에만 라디오 버튼이 활성된다 = 오직 클릭돼 있는 순간만 true 값을 가진다.
- 입력 패널에서 입력을 클릭하고 드래그해 순서를 변경할 수 있다.
- Alt 키를 누르면 삭제 버튼이 뜬다. 또는 우클릭을 통해 삭제할 수 있다.
- 폴더를 통해 입력들을 정리할 수 있다.

## 7.11 조건 Conditions

입력을 전환의 조건으로 사용하는 방법을 설명한다! 우선 전환이 하나 만들어진 걸로 가정한다.

![](img/rive_ch7/conditions.png)

- 전환을 선택하고 우클릭을 하면 Create Conditions이 나타난다. 

> 영상에서는 우측의 인스펙터 창에 조건이 있다고 설명하지만, 현재는 전환을 선택하고 우클릭을 해야 조건을 생성할 수 있다.

- 원하는 입력 변수를 택하면 아래창에 조건 패널이 나타난다. 여기에서 조건을 설정할 수 있다.

> 불리안은 참, 거짓 조건만 설정할 수 있으나 숫자의 경우, 이상, 이하, 같다 등 다양한 조건을 설정할 수 있다.

- 입력의 값이 조건을 만족할 때 전환이 일어난다. 예를 들어 위의 이미지에서는 SWITCH 입력의 값이 1일때 OFF에서 ON으로 전환이 일어난다.

## 7.12 And, Or 전환 생성하기 Creating And Or Transitions

여러 조건을 동시에 충족하거나, 하나 이상의 조건을 만족해야할 때 And와 or을 사용한다. 전환이 하나만 있다 가정하고 설명한다!

### And 전환

![](img/rive_ch7/conditions_and.png)

- 우클릭으로 조건을 만들고, 조건 패널 우측에 있는 + 버튼을 통해 조건을 하나 더 추가한다.
- 이러면 두 조건을 만족할 때만 전환이 일어난다.

### Or 전환

![](img/rive_ch7/conditions_or.png)

- 우클릭으로 조건을 만들고, 전환을 하나 더 만들어 그 전환에도 조건을 추가해준다.
- 이러면 두 조건 중 하나만 만족해도 전환이 일어난다.

## 7.13 초기 입력값 Initial Input values

- 상태 머신을 재생하기 전의 입력값을 기준으로 조건을 확인한다. **즉, 재생하기 전에 넣은 값이 초기값이다!**
- 상태 머신 재생 중에 입력을 바꿀 수 있다 (전환도 적용된다). 그러나 재생을 멈추면 바로 초기값으로 리셋된다.

## 7.14 입력을 변경하기 위해 리스너 사용하기 Using Listeners to change Inputs

리스너는 상태 머신이 사용자의 상호작용을 감지할 수 있게 해준다. 마우스 이동이나 마우스 클릭 같은 작용을 감지하면 그에 맞춰 입력을 변경할 수 있다.

![](img/rive_ch7/listener_ui.png)

- 객체를 선택하고 리스너Listeners 패널의 + 버튼을 누르면 해당 객체가 대상Target이 된 채로 리스너를 생성한다.
- 아무것도 누르지 않은 상태로 리스너 패널의 + 버튼을 누르면 대상이 없는 채로 리스너를 생성한다.

### 리스너 액션 종류

- 인스펙터에서 어떤 행동을 감지할지 정할 수 있다.

![](img/rive_ch7/listener_type.png)

- Pointer Enter: 객체 내에서 포인터가 들어왔을 때
- Pointer Exit: 객체 밖으로 포인터가 나갈 때
- Pointer Down: 객체 내에서 포인터를 누를 때 
- Pointer Up: 객체 내에서 포인터를 뗄 때
- Pointer Move: 객체 내에서 포인터를 움직일 때
- Click: 객체를 클릭할 때

![](img/rive_ch7/listener_input_change.png)

- 리스너를 추가하면 상태 머신 창 아래에 리스너 변수를 설정할 수 있는 창이 뜬다. 해당 창에서 입력에 따라 변수르 변경하면 된다.

> 영상에서는 인스펙터 창에서 추가하지만, 0.8 에서는 아니다. `set - to Value`를 제거하고, + 버튼을 누르고 Input Change를 누른다. 그러면 `fire Select Input`이 뜨며, 해당 항목에서 입력을 설정할 수 있다.

- 상태 머신을 재생하는 중에 리스너에 해당하는 동작을 하면, 설정한대로 입력값이 바뀐다.
- 한 리스너로 여러 입력을 변경할 수 있지만, 여러 액션을 감지하기 위해서는 여러 리스너가 필요하다(1:1)
- 콘솔을 통해 입력의 변경을 확인할 수 있다.

## 7.15 대상을 조정하기 위해 리스너 사용하기 Using Listeners to align targets

리스너를 사용하면 커서를 통해 대상을 조정할 수 있다.

![](img/rive_ch7/listener_align.png)

> 과녁 표시 둘 다 대상Target을 지정할 수 있다.

- 위와 같이 설정하면 포인터를 내릴 때마다 원Ellipse이 이동하게 되는데, 리스너를 설정한 사각형Rectangle 영역 내에서만 움직인다.
- 사각형의 가시성Visibility를 꺼도 원은 사각형 범위 내에서 움직인다.

## 7.16 아무 상태 Any States

아무 상태는 현 상태가 무엇이든 다른 상태로 전환하게 해준다.

![](img/rive_ch7/any_states.png)

- 위의 이미지에서는, 수가 변경될 때마다 사각형의 위치 = 타임라인 상태를 바꾼다.
- 각 전환을 선택해 보간을 설정할 수 있다.
- 리스너로 입력 변경 -> 입력 변경에 따른 전환 조건 설정 -> 타임라인 상태 전환

### 주의점

- 아무 상태와 직접적으로 연결된 상태가 우선순위를 가진다.
- 불리안과 숫자는 계속 그 값을 보유하고, 조건을 매번 확인한다.

> 예를 들어 위에서 상태 3과 새로운 타임라인(루프) 상태를 연결하면, 새로운 타임라인 애니메이션이 버벅이며 제대로 실행되지 않는다. 이 이유는 불리안이나 숫자 같은 입력은 계속 조건을 확인하기 때문에, 상태 3에 대한 전환을 **실행하고나서** 새로운 애니메이션을 실행하게 된다... 이 경우에는 트리거 같은 입력을 사용해야한다.

## 7.17 종료 상태 Exit State

이 상태에 들어가면, 그 상태머신의 레이어는 종료한다.

- 종료 상태는 해당하는 레이어에만 영향을 미친다. 
- 다른 레이어에는 영향을 미치지 않는다.

## 7.18 상태 머신의 흔한 문제들 Common State Machine Issues

- 전환을 잘 실행하기 위해서는 각 타임라인의 키를 잘 지정해야한다.

> 예로 타임라인 A와 타임라인 B로 쌍방향 전환을 만들었다고 하자. 타임라인 A는 키가 잘 찍혀 있고, B는 키가 없다 = 디자인한 그대로다. 이러면 B -> A로는 전환이 잘 일어나지만, A -> B 로는 전환이 일어나지 않게 된다. **A에서 B 로 어떻게 전환해야하는지 키가 없기 때문이다.**

## 7.19 간단한 버튼 만들기Build a simple button

![](img/rive_ch7/simple_button.png)

연습 섹션이다. 레이어, 입력, 리스너, 조건, 전환을 통해 간단한 버튼을 만드는 부분이다.


## 7.20 더블클릭 상호작용 만들기 Build a double click interaction

![](img/rive_ch7/double_click.png)

연습 섹션이다.

- 위와 같이 상태를 두 개 만들어, 클릭을 두번 받도록 한다.
- 일정 시간 내에 더블클릭하게 만들기: Exit Time을 사용해 시간 내에 클릭하지 않음 초기화한다.
- 기본 상태가 하트의 크기를 0%, 0%로 만들기 때문에 히트 박스를 따로 만들어야한다.

## 7.21 간단한 메뉴 만들기 Build a simple menu

![](img/rive_ch7/simple_menu.png)

연습 섹션이다.

- 버튼 별로 입력, 리스너를 만들어 호버링될 때 On 상태로 전환한다 = 색을 바꾼다.
- 클릭하면 Button_select의 값이 바뀐다. 값에 해당되는 버튼은 On 상태로 전환한다.

> 색이 꺼지는 경우는 Button_hover 입력이 false고 Button_select의 값에 해당되지 않을때 꺼진다. 이렇게 해서 클릭하면 버튼을 On 상태로 만들 수 있다.

## 7.22 중첩된 아트보드의 입력을 노출시키기 Exposing Inputs from Nested Artboards

![](img/rive_ch7/two_artboards.png)

위와 같은 아트보드가 있다고 하자. 붉은색 아트보드가 부모Parent, 파란색 아트보드가 자식Child이다. 자식 아트보드에는 입력, 리스너, 전환 등을 다 설정해놓은 상태다. 부모 아트보드에는 중첩된 아트보드Nested Artboard로 파란색 아트보드를 가지고 왔다.

- 중첩된 아트보드를 가지고 오면 그 상태머신을 사용할 수 있다. (붉은색 아트보드를 선택한 채로 상태 머신을 재생하면, 파란색 아트보드의 전환을 사용할 수 있게 된다.)
- 자식 아트보드에서 입력을 노출시킬 수 있다. 해당 체크박스를 클릭하면 된다.

![](img/rive_ch7/expose_to_parent.png)

> 전체화면 등 화면 비율이 커야 체크박스가 보인다. 

- 노출시키면 부모 아트보드에서 그 입력을 볼 수 있다. 해당 입력을 통해 상태머신을 제어할 수 있다.

![](img/rive_ch7/child_artboard_expose.png)

- 한 아트보드에 대해 여러개의 중첩된 아트보드를 생성하면 중첩 아트보드 별로 별개의 입력이 생성된다.
- 만약 기준이 되는 아트보드에서 입력 노출을 중지하면, 이 아트보드를 참고하는 모든 중첩된 아트보드에서는 그 입력에 접근할 수 없다.

> 어느게 어느 변수인지 알기위해서는 중첩된 아트보드, 입력 등 이름을 제대로 작성해야한다!

## 7.23 노출된 입력을 리스너로 제어하기 Controlling Exposed Inputs with Listeners

- 부모 아트보드에서 리스너를 생성해, 노출된 입력들을 제어할 수 있다.

## 7.24 노출된 입력을 키로 제어하기 Controlling Exposed Inputs with Keys

![](img/rive_ch7/controll_with_keys.png)

- 중첩된 아트보드를 선택하고, 타임라인에 들어가면 입력을 키로 설정할 수 있는 패널이 나타난다.
- 입력이 바뀔 때마다 그에 설정된 전환이 일어난다.

> 숫자에 대해서 키를 설정하면 그 사이에 소수로 값이 입력된다. 이 때문에 조건을 `==`로 설정한 전환은 제대로 변경되지 않는다. 보간을 Hold로 변경하거나, 제어 조건을 `==` 일치가 아닌 `>=` 이상이나 `<=`이하로 바꾸면 해결된다.

## 7.25 중첩된 아트보드에 이벤트 사용하기 Using Events with Nested Artboards

이벤트를 통해 부모 아트보드의 입력을 제어한다.

![](img/rive_ch7/event_report.png)

- 자식 아트보드에서 이벤트를 생성한다. (단축키 윗키 + `E`) 리스너를 통해 특정 행동마다 Report Event를 통해 해당 이벤트를 실행시킨다.
- 이를 통해 중첩된 아트보드에서 리스너를 통해 (자식 아트보드에 생성한) 이벤트를 사용할 수 있다. 중첩된 아트보드에서 리스너를 생성하면 이벤트를 기준으로 입력을 제어할 수 있게 된다.

> 사용자가 특정 행동(클릭, 포인터 진입)을 한다 > 자식 아트보드에서 이벤트가 발생한다 > 부모 아트보드의 리스너가 이벤트 변화를 감지한다 > 부모 아트보드의 입력이 제어된다

## 7.26 소리 이벤트 Audio Event

음성 파일을 사용하는 법에 대해 설명한다...만,

Rive에서 음성 파일을 가지고 오려면 유료 결제를 해야한다. 그래도 Rive에서 기본적으로 제공하는 음성이 있으니 걱정하진 말자

![](img/rive_ch7/event_inspector.png)

- 이벤트를 생성하고 인스펙터를 보면 종류Type에서 Audio를 택할 수 있다.
- 있는 음성 파일을 가지고 오거나 (결제 필요), Browse sounds를 통해 Rive에서 기본 제공하는 음성을 사용할 수 있다. 
- Browse sounds의 음성을 가지고 오면 (좌측) 에셋 창에 추가된다. 추가되면 이벤트에 Audio Properties - Asset을 통해 해당 음성을 추가할 수 있다.

![](img/rive_ch7/audio_asset.png)

- 음성의 볼륨이 너무 크다면 **에셋의 인스펙터**의 볼륨Volume을 통해 조정할 수 있다.

> Volume은 애니메이션처럼 키를 넣을 수 있는 것은 아니다. 즉, 페이드인 페이드아웃을 설정할 수 없다. 하지만 언젠가 추가할 것이라고...

![](img/rive_ch7/waveform.png)

- 음성의 길이가 너무 길다면 해당 음성을 선택할 때 나오는 음파Waveform 창을 통해 음성을 일부 자를 수 있다.
- `+`버튼을 누르면 에셋창에서 자식 에셋으로 나타난다.

### 사용법

우선 해당 에셋을 아트보드로 가지고 온다. 이러면 자동으로 음성이 이벤트로 추가된다.

1. 애니메이션 타임라인에서 재생Play Audio를 키로 설정할 수 있다.

![](img/rive_ch7/event_audio.png)

2. 전환의 이벤트를 설정할 때 음성을 설정할 수 있다.

3. 리스너를 통해 Report Fire > 음성 이벤트로 설정해 특정행동이 있을시 음성을 재생할 수 있다.

### 한계

- 사용자가 해당 파일을 클릭하기 전까지는 음성이 재생되지 않는다.
- 시작 버튼 같은 것을 넣어 사용자가 클릭하도록 유도하는 걸 추천한다고...

